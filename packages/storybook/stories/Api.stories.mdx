import { Meta } from '@storybook/addon-docs';

<Meta title="API/core" />

# Hooks

## useFormz

This hook defines the entry point of the form, providing a `Form` component that provides the
context to the fields below it.

### Input

None.

### Output

|Name|Description|
|----|-----------|
|`Form`|A `Form` component that is the provider for the rest of the form elements|

### Example

```jsx
import { useFormz } from '@formz/core'

const MyForm = () => {
  const onSubmit = async ({ values }) => console.log(values)
  const { Form } = useFormz()

  return (
    <Form onSubmit={onSubmit}>
      <FieldA />
      <FieldB />
      <SubmitButton />
    </Form>
  )
}
```

## useFormzContext

Provides access to the entire form context state in any component rendered under the `Form` provider.

### Input

None.

### Output

|Name|Description|
|----|-----------|
|`values`|The current values of all the fields in the form|
|`fields`|A map of `<field name, field state>` providing all the internal state of each field in the form|
|`form`|The internal state of the form|

### Example

```jsx
import { useFormzContext, useFormz } from '@formz/core'

const MyFormState = () => {
  const { values, fields, form } = useFormzContext()
  console.log('Values', values)
  console.log('Fields', fields)
  console.log('Form', form)
  return null
}

const MyForm = () => {
  const onSubmit = async ({ values }) => console.log(values)
  const { Form } = useFormz()

  return (
    <Form onSubmit={onSubmit}>
      <MyFormState />
      <FieldA />
      <FieldB />
      <SubmitButton />
    </Form>
  )
}
```

## useFormzField

Defines a field in the form and provides access to the field internal state and value.

### Input

|Name|Description|Default|Required|
|----|-----------|-------|--------|
|`name`|The name of the field. Supports deep object nesting using `.` notation, for example: `user.firstName` will result in the form `values` passed to `onSubmit` with `{ user: { firstName } }`|-|‚úì|
|`defaultValue`|The default value of the field|-|êÑÇ|
|`validate`|A function that will be called to validate the field value. This function will be called when the form is submitted, or for events where `validateOnX` parameter is true|-|‚úì|
|`parse`|A function that will be called with the field value when the field `onChange` is called, and can parse the input value to a different value that will be stored in the form state|-|‚úì|
|`format`|A function that will be called with the field stored value and returned as the `value` of the field in the output|-|‚úì|
|`validateOnInit`|Should the `validate` function run when the field is first initialized|`false`|‚úì|
|`validateOnBlur`|Should the `validate` function run when the field is blurred (everytime `onBlur` is called)|`true`|‚úì|
|`validateOnChange`|Should the `validate` function run when the field value is changing (everytime `onChange` is called)|`false`|‚úì|

### Output

|Name|Description|
|----|-----------|
|`form`|The internal state of the form|
|`fields`|A map of `<field name, field state>` providing all the internal state of each field in the form|
|`values`|The raw values of the entire form|
|`field`|The field internal state|
|`rawValue`|The stored value of the field|
|`value`|The value of the field. If `format` was provided, will be the result of the `format` function, otherwise will be the `rawValue`|
|`name`|The name of the field|
|`defaultValue`|The provided `defaultValue` of the field|
|`inputProps`|A quick set of props that is commonly used by UI elements for interacting with the field, for easy spread on the element|
|`inputProps.value`|The same as `value`|
|`inputProps.onChange`|A function that should be called to update the field value|
|`inputProps.onBlur`|A function that should be called when the field loses focus|

### Example

```jsx
import { useFormzField, useFormz } from '@formz/core'

const NameInput = () => {
  const { inputProps } = useFormzField({ name: 'fullName', defaultValue: '' })
  return <input {...inputProps} />
}

const MyForm = () => {
  const onSubmit = async ({ values }) => console.log(values)
  const { Form } = useFormz()

  return (
    <Form onSubmit={onSubmit}>
      <NameInput />
      <SubmitButton />
    </Form>
  )
}
```

# Components

## Form

The `Form` component renders a `FormzContext.Provider` component and passes the entire form state
to it, so it is available to the `Form` children using the `useFormzContext` or `useField` hooks.

The `children` are wrapped with a `form` tag, and you can provide additional props to it via
`formProps` prop on the `Form`.

The `Form` component supports the following props:

|Name|Description|Default|Required|
|----|-----------|-------|--------|
|`onSubmit`|A callback function that will be called when the form is submitted|-|‚úì|
|`formProps`|Props that should be passed on to the `form` tag that is wrapping the `children`. All valid `form` tag props are supported|-|êÑÇ|
|`onSubmitSuccess`|A callback function that will be called with the result of `onSubmit` in case of successful submission|-|êÑÇ|
|`onSubmitError`|A callback function that will be called with the error of `onSubmit` in case of failed submission|-|êÑÇ|
